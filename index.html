<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Media Decompiler (50MB)</title>
</head>
<body>
    <h2>Upload Media to Decompile</h2>
    <input type="file" id="fileInput" accept="image/*,video/*">
    <button onclick="decompile()">Decompile</button>

    <h3>Extracted Code (Compressed & Editable):</h3>
    <textarea id="output" rows="10" cols="50"></textarea>

    <h3>Recompile from Code</h3>
    <button onclick="recompile()">Recompile</button>

    <script>
        function decompile() {
            let file = document.getElementById("fileInput").files[0];
            if (!file) {
                alert("Please upload a file.");
                return;
            }

            // Limit file size to 50MB
            if (file.size > 50 * 1024 * 1024) {
                alert("File too large! Please upload a file smaller than 50MB.");
                return;
            }

            let reader = new FileReader();
            reader.onload = function(event) {
                let base64Data = event.target.result.split(',')[1]; // Extract Base64

                // Compress to keep it under 1MB
                if (base64Data.length > 1024 * 1024) {
                    base64Data = base64Data.substring(0, 1024 * 1024);
                    alert("File is too large! Only the first 1MB of data is processed.");
                }

                document.getElementById("output").value = base64Data;
            };
            reader.readAsDataURL(file); // Convert to Base64
        }

        function recompile() {
            let base64String = document.getElementById("output").value.trim();
            if (!base64String) {
                alert("Please enter Base64 data.");
                return;
            }

            let binaryData = atob(base64String); // Convert Base64 to binary
            let arrayBuffer = new Uint8Array(binaryData.length);
            for (let i = 0; i < binaryData.length; i++) {
                arrayBuffer[i] = binaryData.charCodeAt(i);
            }

            let blob = new Blob([arrayBuffer]); // Create file blob

            let link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = "recompiled_media";
            link.click();
        }
    </script>
</body>
</html>
